<NodeSquare Node="Node" Selected="Cell.IsMarked" OnClick="@(OnClick!)" ShowTagBadge="ShowTagBadge" ShowTagBadgeTooltip="ShowTagBadge" />

@code {
    [CascadingParameter]
    public PlayerState State { get; set; } = default!;

    [Parameter, EditorRequired]
    public PlayerCardCellData Cell { get; set; } = default!;

    [Parameter]
    public bool ReadOnly { get; set; }

    public NodeViewModel? Node => Cell.Node == null ? null : new NodeViewModel(Cell.Node);

    private bool CanMark => !ReadOnly && State.GameState.State is GameStateEnum.Active or GameStateEnum.FinalCountdown;

    private Action? OnClick => CanMark ? Mark : null;

    private bool ShowTagBadge => State.GameState.Preset.ShowTagBadges;

    private void Mark()
    {
        if (CanMark)
        {
            State.Mark(Cell.Col, Cell.Row);
        }
    }
}
